# 论文摘要生成器配置文件

# API配置（按功能区分服务商）
api:
  # 文本生成配置
  text:
    provider: "siliconflow"  # openai / anthropic / siliconflow
    base_url: "https://api.siliconFlow.cn/v1"
    model: "deepseek-ai/DeepSeek-V3.2"
    timeout: 120

  # 图像/VL分析配置
  vl:
    provider: "siliconflow"  # openai / anthropic / siliconflow
    base_url: "https://api.siliconFlow.cn/v1"
    model: "Qwen/Qwen2-VL-7B-Instruct"
    timeout: 120

  # API密钥从环境变量自动读取: {PROVIDER}_API_KEY
  # 例如: SILICONFLOW_API_KEY, OPENAI_API_KEY, ANTHROPIC_API_KEY

# Browser/Playwright 配置
browser:
  enabled: true                    # 启用 Playwright 抓取
  headless: true                   # 无头模式（不显示浏览器窗口）
  timeout: 30000                   # 页面加载超时 (ms)
  user_agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36"
  cache_enabled: true              # 启用抓取结果缓存
  cache_ttl: 86400                 # 缓存有效期 (秒，24小时)
  cache_dir: "./cache/html"        # HTML 缓存目录

# arXiv 配置
arxiv:
  api_url: "http://export.arxiv.org/api/query"
  pdf_url: "https://arxiv.org/pdf/{id}.pdf"
  user_agent: "PaperSummaryBot/1.0"

# papers.cool 配置
papers_cool:
  base_url: "https://papers.cool"
  kimi_endpoint: "/arxiv/kimi"
  timeout: 60

# 降级配置：当 Playwright 不可用时的回退策略
flex_mode:
  enabled: false                 # 默认禁用回退，只有 true 时才允许 API 回退
  arxiv_api: true                # arXiv API 不可用时回退
  papers_cool_api: false         # papers.cool API 不可用时回退（默认禁用）

# 路径配置
paths:
  cache_dir: "./cache"
  pdf_dir: "./cache/pdfs"
  summaries_dir: "./cache/summaries"
  logs_dir: "./cache/logs"
  comments_dir: "./data/comments"
  templates_dir: "./templates"

# PDF处理配置
pdf:
  # 提取PDF文字时的最大页数 (0表示不限制)
  max_pages: 0
  # 提取的文本长度限制
  max_chars: 50000

# 摘要生成配置
summary:
  # Prompt模板文件 (templates/目录下的文件名)
  # 可选模板:
  #   - academic_summary.md.j2: 传统学术摘要格式 (研究背景 → 方法 → 贡献与结果 → 结论)
  #   - structured_analysis.md.j2: 结构化分析格式 (包含可信度、重要性、端侧价值等评估维度)
  #   - ppt_slide.md.j2: PPT Slide格式 (1-2页精简演示稿，左文右图布局)
  template: "structured_analysis.md.j2"

  # 生成模式
  #   - full: 完整模式，使用Kimi摘要+PDF内容生成详细摘要（默认）
  #   - lightweight: 轻量模式，只使用Kimi摘要生成快速摘要
  #   - two_phase: 两阶段模式，先用Kimi摘要生成框架，再用PDF内容增强
  mode: "two_phase"

  # PDF增强配置 (仅two_phase模式生效)
  # 是否在第二阶段才请求PDF内容（避免一次性发送过长上下文）
  pdf_enhance_enabled: true
  # 温度参数
  temperature: 0.3
  # 最大Token数
  max_tokens: 4096
  # 重试次数
  max_retries: 3

# 日志配置
logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
